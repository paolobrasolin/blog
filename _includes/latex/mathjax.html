<script type="text/javascript">
$(document).ready(function() {
  /* Hide and clean preamble */
  $('#preamble').addClass("hidden");
  $('#preamble').append(
    '<script type="math\/tex; mode=display ">'
        +$('#preamble').data('macros')+'<\/script>');
  /* Inline math */
  $('code').not('pre code').each(function() {
    var match = /^\$([^\$]*)\$$/.exec($(this).text());
    if(match) { $(this).replaceWith(
      '<script type="math\/tex">'
        +match[1]+'<\/script>'); }
  });
  /* Display math */
  $('.language-tex').parent().parent().each(function() {
    var match = /^\$\$([^\$]*)\$\$$/m.exec($(this).text());
    if(match) { $(this).replaceWith(
      '<script type="math\/tex; mode=display">'
        +match[1]+'<\/script>');}
  });
});
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  /* No preprocessor. We already did the work. */
  /* This is going to need some fine tuning. */
  jax: [
    "input/TeX",
    "output/HTML-CSS",
    "output/CommonHTML"
  ],
  /*extensions: [
    "MathMenu.js",
    "MathZoom.js",
    "CHTML-preview.js",
    "MatchWebFonts.js"
  ],
  MatchWebFonts: {
    matchFor: {
      "HTML-CSS": true,
      NativeMML: false,
      SVG: false
    },
    fontCheckDelay: 2000,
    fontCheckTimeout: 30 * 1000
  },*/
  "HTML-CSS": {
    preferredFont: "STIX",
    webFont: "STIX-Web",
    styles: {
      ".MathJax_Display": {
        margin: "-13px none",
        "max-width": "34em"
      }
    }
  },
  TeX: {
    extensions: [
      "AMSmath.js",
      "AMSsymbols.js",
      "noErrors.js",
      "noUndefined.js"
    ]
  }
});
</script>

<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
